/* * Dave Rosenberg * Comp 2000 - Data Structures * Lab: Stack ADT * Fall, 2019 *  * Usage restrictions: *  * You may use this code for exploration, experimentation, and furthering your * learning for this course. You may not use this code for any other * assignments, in my course or elsewhere, without explicit permission, in * advance, from myself (and the instructor of any other course). *  * Further, you may not post or otherwise share this code with anyone other than * current students in my sections of this course. Violation of these usage * restrictions will be considered a violation of the Wentworth Institute of * Technology Academic Honesty Policy. * * Do not remove this notice. */package edu.wit.dcsn.comp2000.stack.adt;import java.util.Arrays;import java.util.EmptyStackException;import edu.wit.dcsn.comp2000.stack.common.TestableStackInterface;/** * A class of stacks whose entries are stored in an array. *  * @author Frank M. Carrano * @author Timothy M. Henry * @version 5.0 *  * @author Dave Rosenberg * @version 4.1.0 2019-02-08 add toArray(), toString() and main() * @version 5.1.0 2019-06-09 update to match 5th edition of textbook * @version 5.2.0 2019-10-07 *          <ul> *          <li>switch interface to work with new testing framework *          <li>remove toString() *          </ul> *  * @author Sunny Lee * @version 5.3.0 2019-10-08 per assignment: *          <ul> *          <li>reverse implementation so the bottom of the stack is in *          {@code this.stack[stack.length-1]} instead of {@code this.stack[0]} *          <li>finish implementation *          </ul> *  * @param <T> The type of all objects to store in the stack */public final class ArrayStack<T> implements TestableStackInterface<T> {	private T[] stack; // Array of stack entries	private int topIndex; // Index of top entry	private boolean integrityOK;	// the following changed from private to package visible for testing	/** initial capacity if not specified */	static final int DEFAULT_CAPACITY = 50;	/** largest capacity supported by this implementation */	static final int MAX_CAPACITY = 10000;	/*	 * constructors	 */	/**	 * Create an ArrayStack with a default/initial capacity of DEFAULT_CAPACITY	 */	public ArrayStack() {		this(DEFAULT_CAPACITY);	} // end no-arg constructor	/**	 * Create an ArrayStack with an initial capacity specified by the application	 * 	 * @param initialCapacity the initial capacity (limited by MAX_CAPACITY)	 */	public ArrayStack(int initialCapacity) {		integrityOK = false;		checkCapacity(initialCapacity);		// The cast is safe because the new array contains null entries		@SuppressWarnings("unchecked")		T[] tempStack = (T[]) new Object[initialCapacity];		stack = tempStack;				topIndex = initialCapacity; //set topIndex to the size of the array instead of starting it at -1		integrityOK = true;	} // end 1-arg (initial capacity) constructor	/*	 * public API methods	 */	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.StackInterface#clear()	 */	@Override	public void clear() {		checkIntegrity();		// Remove references to the objects in the stack,		// but do not deallocate the array		while (topIndex < stack.length) {			stack[topIndex] = null;			topIndex++;		} // end while	} // end clear()	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.StackInterface#isEmpty()	 */	@Override	public boolean isEmpty() {		return topIndex == stack.length;	} // end isEmpty()	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.StackInterface#peek()	 */	@Override	public T peek() {		checkIntegrity();		if (isEmpty()) {			throw new EmptyStackException();		}		return stack[topIndex];	} // end peek()	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.StackInterface#pop()	 */	@Override	public T pop() {		checkIntegrity();		if (isEmpty()) {			throw new EmptyStackException();		}		T top = stack[topIndex];		stack[topIndex] = null; //set the current stack at topIndex to null		topIndex++; 		return top;	} // end pop()	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.StackInterface#push(java.lang.Object)	 */	@Override	public void push(T newEntry) {		checkIntegrity();		ensureCapacity();		stack[topIndex - 1] = newEntry;		topIndex--;	} // end push()	/*	 * testing API methods	 */	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.TestableStackInterface#size()	 */	@Override	public int size() {		return stack.length - topIndex; //gives the size of the stack 	} // end size()	/*	 * (non-Javadoc)	 * 	 * @see edu.wit.dcsn.comp2000.stackadt.TestableStackInterface#toArray()	 */	@Override	public T[] toArray() {		// The cast is safe because the new array contains null entries		@SuppressWarnings("unchecked")		T[] tempStack = (T[]) new Object[stack.length - topIndex];				//take the stack at topIndex and copy that into tempStack starting at 0 		System.arraycopy(stack, topIndex, tempStack, 0, stack.length - topIndex);				return tempStack;	} // end toArray()	/*	 * private utility methods	 */	/**	 * Throw an exception if the client requests a capacity that is too large or	 * otherwise invalid.	 * 	 * @param capacity the desired capacity - must be greater than or equal to 1 and	 *                 less than or equal to MAX_CAPAACITY	 */	private void checkCapacity(int capacity) {		if (capacity > MAX_CAPACITY) {			throw new IllegalStateException(					"Attempt to create a stack " + "whose capacity exceeds " + "allowed maximum.");		} 				//throws an IllegalStateException when the capacity is less or equal to zero		if(capacity <= 0)			throw new IllegalStateException("Attempt to create a stack whose capacity is zero or negative.");			} // end checkCapacity()	/**	 * Throw an exception if this object is not initialized.	 */	private void checkIntegrity() {		if (!integrityOK) {			throw new SecurityException("ArrayStack object is not " + "initialized properly.");		}	} // end checkIntegrity()	/**	 * Doubles the size of the array stack if it is full	 * 	 * <p>	 * Precondition: checkIntegrity has been called.	 */	private void ensureCapacity() {		if (topIndex == 0) // If array is full, double its size		{			int newLength = 2 * stack.length;			checkCapacity(newLength);						@SuppressWarnings("unchecked")			T[] newStack = (T[]) new Object[newLength];						//copy stack to newStack 			System.arraycopy(stack, 0, newStack, stack.length, stack.length); 			topIndex = stack.length; 			stack = newStack; 		} // end if	} // end ensureCapacity()	/*	 * testing/debugging methods	 */	/**	 * (optional) driver for testing/debugging	 * 	 * @param args -unused-	 */	public static void main(String[] args) {		// STUB for optional testing/debugging		// NOTE do not put your unit testing here					} // end main()} // end class ArrayStack